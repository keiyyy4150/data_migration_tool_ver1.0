Attribute VB_Name = "modGlobals"
Option Explicit

'=== フォルダ名（ツールと同階層） ===
Public Const IMPORT_FOLDER As String = "importFiles"
Public Const EXPORT_FOLDER As String = "exportFiles"
Public Const LOG_FOLDER    As String = "log"

'=== エンコード（AUTO/UTF-8/Shift_JIS/UTF-16LE） ===
Public CurrentEncodingMode As String ' 空なら "AUTO" を採用

'=== どのパイプラインを処理するか（Main/List） ===
'   ※テーブル名（＝シート名）で管理します
Public CurrentMappingTableName As String ' 例: "Mapping_Main" / "Mapping_List"
Public CurrentMasterTableName  As String ' 例: "Master_Main"  / "Master_List"
Public CurrentExportPrefix     As String ' "MAIN_" / "LIST_" 等

'=== 共有データ（Import → Processで再利用） ===
Public TableData As Object ' Scripting.Dictionary : Key=テーブル名, Val=2次元配列
Public KeyIndex  As Object ' Scripting.Dictionary : Key=テーブル名, Val=Dictionary(KeyStr -> 行Index)
Public RawJoined As Variant ' 無加工JOIN結果
Public HasRaw    As Boolean ' RawJoinedがあるか
Public IsProcessed As Boolean ' Masterにあるのが加工済みかどうか

'=== JOIN時のベース表情報（RawJoinedを再構築するときに使う） ===
Public m_baseTblName As String
Public m_baseRowIdx() As Long ' 出力行 i → ベース表の実行Index（2〜）

'=== Mappingキャッシュ（テーブルから読込み） ===
'   ※行は 1..N で揃えています
Public Map_OutCols()  As String  ' 出力カラム名（Master見出しと一致）
Public Map_DataType() As String  ' 型 TEXT/NUMBER/DATE
Public Map_Logic()    As String  ' 置換ロジック "a→b;c→d"
Public Map_IsKey()    As Boolean ' 複合キー ○/空
Public Map_Mode()     As String  ' VALUE/CONCAT/EXPR
Public Map_Def()      As String  ' CONCATの列挙 or EXPRの式/テンプレ/IF*
Public Map_TblNames() As String  ' H1以降のヘッダ：テーブル名（CSV名の拡張子なし）
Public Map_SrcCols    As Variant ' (行=出力列, 列=テーブル) の元カラム名

'=== エクスポートのベース名（ファイル名に使用） ===
Public Const EXPORT_BASENAME As String = "inventory"