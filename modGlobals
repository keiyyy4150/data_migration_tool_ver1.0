Option Explicit

'==============================
' グローバル定数・共有状態
'==============================
Public Const IMPORT_FOLDER As String = "importFiles"
Public Const EXPORT_FOLDER As String = "exportFiles"
Public Const LOG_FOLDER    As String = "log"

' パイプラインで使うテーブル名（ListObject名）
Public CurrentMappingTableName As String ' Mapping_Main / Mapping_List
Public CurrentMasterTableName  As String ' Master_Main  / Master_List
Public CurrentExportPrefix     As String ' MAIN_ / LIST_

' エンコード設定（AUTO/UTF-8/SHIFT_JIS/UTF-16LE）
Public CurrentEncodingMode As String

' インポート／加工状態
Public HasRaw As Boolean
Public IsProcessed As Boolean

' 取り込んだ全テーブル
'  TableData("tbA") = Variant(2D)  ※1行目はヘッダ
'  KeyIndex("tbA")  = Dictionary(keyStr -> 行Index(2〜))
Public TableData As Object ' Scripting.Dictionary
Public KeyIndex  As Object ' Scripting.Dictionary

' Masterに貼る直前の無加工（JOIN済み）配列
Public RawJoined As Variant

'==============================
' パイプライン切替（Main / List）
'==============================
Public Sub UsePipelineMain()
    CurrentMappingTableName = "Mapping_Main"
    CurrentMasterTableName  = "Master_Main"
    CurrentExportPrefix     = "MAIN_"
    WriteLog "INFO", "Switched pipeline: Main"
End Sub

Public Sub UsePipelineList()
    CurrentMappingTableName = "Mapping_List"
    CurrentMasterTableName  = "Master_List"
    CurrentExportPrefix     = "LIST_"
    WriteLog "INFO", "Switched pipeline: List"
End Sub