Public Function BuildValueModeRaw(colIndex As Long, baseTbl As String, baseRow As Long, myKey As String, _
                                  Optional matchIndex As Long = 1) As Variant
    Dim t As Long, v As Variant
    v = ""
    If (Not Not Map_TblNames) = 0 Then BuildValueModeRaw = v: Exit Function

    Dim isValue As Boolean
    isValue = (UCase$(Map_Mode(colIndex)) = "VALUE" Or Len(Map_Mode(colIndex)) = 0)

    For t = LBound(Map_TblNames) To UBound(Map_TblNames)
        Dim names As Collection: Set names = SafeGetSrcColNames(colIndex, t)
        If names Is Nothing Or names.Count = 0 Then GoTo CONT_T

        If Map_TblNames(t) = baseTbl Then
            ' ===== ベーステーブル：既存どおり、VALUEは複数列を改行連結 =====
            Dim arr As Variant: arr = TableData(baseTbl)
            Dim acc As String: acc = ""
            Dim j As Long, one As String, ci As Long, valStr As String
            For j = 1 To names.Count
                one = names(j)
                If IsNumeric(one) Then
                    ci = CLng(one)
                Else
                    ci = FindColumnIndex(arr, one)
                End If
                If ci > 0 Then
                    valStr = CStr(arr(baseRow, ci))
                    If isValue Then
                        If Len(valStr) > 0 Then
                            If Len(acc) = 0 Then acc = valStr Else acc = acc & vbLf & valStr
                        End If
                    Else
                        v = valStr: Exit For
                    End If
                End If
            Next
            If isValue Then v = acc
            If Len(CStr(v)) > 0 Then BuildValueModeRaw = v: Exit Function

        Else
            ' ===== ベース以外のテーブル：ここを修正 =====
            ' これまで「最初に見つかった1個で終了」だったのを、
            ' MODE=VALUE のときは複数列を改行連結するように変更
            Dim acc2 As String: acc2 = ""
            Dim j2 As Long, nm As String, got As String
            For j2 = 1 To names.Count
                nm = names(j2)
                got = GetValueFromTableMulti(Map_TblNames(t), nm, myKey, matchIndex)
                If isValue Then
                    If Len(got) > 0 Then
                        If Len(acc2) = 0 Then acc2 = got Else acc2 = acc2 & vbLf & got
                    End If
                Else
                    If Len(got) > 0 Then v = got: Exit For
                End If
            Next
            If isValue Then v = acc2
            If Len(CStr(v)) > 0 Then BuildValueModeRaw = v: Exit Function
        End If
CONT_T:
    Next
    BuildValueModeRaw = v
End Function